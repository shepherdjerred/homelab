apiVersion: onepassword.com/v1
kind: OnePasswordItem
metadata:
  name: glitter-boys-prod-lavalink-password
  namespace: glitter-boys-prod
spec:
  itemPath: vaults/v64ocnykdqju4ui6j6pua56xw4/items/lvcjg2hn2bafskjrlsxgi4oq44
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: glitter-boys-prod-lavalink
  namespace: glitter-boys-prod
spec:
  minReadySeconds: 0
  progressDeadlineSeconds: 600
  replicas: 1
  selector:
    matchLabels:
      cdk8s.io/metadata.addr: glitter-boys-prod-lavalink-c84c49a4
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        cdk8s.io/metadata.addr: glitter-boys-prod-lavalink-c84c49a4
    spec:
      automountServiceAccountToken: false
      containers:
        - env:
            - name: TZ
              value: America/Los_Angeles
            - name: SERVER_PORT
              value: "2333"
            - name: LAVALINK_SERVER_SOURCES_YOUTUBE
              value: "true"
            - name: LAVALINK_SERVER_PASSWORD
              valueFrom:
                secretKeyRef:
                  key: password
                  name: glitter-boys-prod-lavalink-password
          imagePullPolicy: Always
          name: main
          ports:
            - containerPort: 2333
              name: port-2333
              protocol: TCP
            - containerPort: 80
              name: port-80
              protocol: TCP
            - containerPort: 443
              name: port-443
              protocol: TCP
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsGroup: 1000
            runAsNonRoot: true
            runAsUser: 1000
      dnsPolicy: ClusterFirst
      hostNetwork: false
      restartPolicy: Always
      securityContext:
        fsGroupChangePolicy: Always
        runAsNonRoot: true
      setHostnameAsFQDN: false
      terminationGracePeriodSeconds: 30
---
apiVersion: v1
kind: Service
metadata:
  name: glitter-boys-prod-lavalink-service
  namespace: glitter-boys-prod
spec:
  externalIPs: []
  ports:
    - port: 2333
  selector:
    cdk8s.io/metadata.addr: glitter-boys-prod-lavalink-c84c49a4
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: glitter-boys-prod-glitter-backend
  namespace: glitter-boys-prod
spec:
  minReadySeconds: 0
  progressDeadlineSeconds: 600
  replicas: 1
  selector:
    matchLabels:
      cdk8s.io/metadata.addr: glitter-boys-prod-glitter-backend-c8cbcc79
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        cdk8s.io/metadata.addr: glitter-boys-prod-glitter-backend-c8cbcc79
    spec:
      automountServiceAccountToken: false
      containers:
        - env:
            - name: TZ
              value: America/Los_Angeles
            - name: APPLICATION_ID
              value: "716834761418735638"
            - name: AWS_ACCESS_KEY_ID
              valueFrom:
                secretKeyRef:
                  key: access-key-id
                  name: glitter-boys-prod-aws-access-key
            - name: AWS_SECRET_ACCESS_KEY
              valueFrom:
                secretKeyRef:
                  key: secret-access-key
                  name: glitter-boys-prod-aws-access-key
            - name: AWS_ENDPOINT_URL
              value: https://48948ed6cd40d73e34d27f0cc10e595f.r2.cloudflarestorage.com
            - name: AWS_REGION
              value: auto
            - name: DISCORD_TOKEN
              valueFrom:
                secretKeyRef:
                  key: credential
                  name: glitter-boys-prod-discord-token
            - name: GUILD_ID
              value: "208425771172102144"
            - name: LAVALINK_PASSWORD
              valueFrom:
                secretKeyRef:
                  key: password
                  name: glitter-boys-prod-lavalink-password
            - name: LAVALINK_URL
              value: glitter-boys-prod-lavalink-service:2333
            - name: LEADERBOARD_ROLE_ID
              value: "1179152455657865318"
            - name: LEAGUE_CHANNEL_ID
              value: "1194779777589059656"
            - name: RIOT_API_TOKEN
              valueFrom:
                secretKeyRef:
                  key: credential
                  name: glitter-boys-prod-riot-api-key
            - name: S3_BUCKET_NAME
              value: glitter-boys-prod
            - name: DATA_DIR
              value: /data
            - name: SENTRY_DSN
              value: https://bd27a021788f532b6c679d4977f5acc3@o92742.ingest.sentry.io/4506843178991616
          imagePullPolicy: Always
          name: main
          ports:
            - containerPort: 8000
              name: port-8000
              protocol: TCP
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          volumeMounts:
            - mountPath: /data
              name: pvc-glitter-data-prod
            - mountPath: /workspace/packages/backend/players.json
              name: configmap-glitter-boys-prod-glitter-players
              subPath: players.json
      dnsPolicy: ClusterFirst
      hostNetwork: false
      restartPolicy: Always
      securityContext:
        fsGroupChangePolicy: Always
        runAsNonRoot: true
      setHostnameAsFQDN: false
      terminationGracePeriodSeconds: 30
      volumes:
        - name: pvc-glitter-data-prod
          persistentVolumeClaim:
            claimName: glitter-data-prod
            readOnly: false
        - configMap:
            items:
              - key: players.json
                path: players.json
            name: glitter-boys-prod-glitter-players
          name: configmap-glitter-boys-prod-glitter-players
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: glitter-data-prod
  namespace: glitter-boys-prod
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
  volumeMode: Filesystem
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: glitter-boys-prod-glitter-players
  namespace: glitter-boys-prod
data:
  players.json: |
    [
      {
        "name": "Jerred",
        "league": {
          "leagueAccount": {
            "id": "T0unTFnLyDJ5TVfhWOQNBI2aZIjDBEw9F73oHrE5idNNZAo",
            "accountId": "f9SPdxzjg93nJ8W4F44u36cfrldmHzX6IQvKLFKb2J1piw",
            "puuid": "EjRmQ1H7E1md8UNw_9BwqcIxN3QqKMkP7aPQFLOrIcV5HoH5qulKRCBAT1ibn5EgrljZ82RT1sjccg",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "160509172704739328" },
        "tier": {
          "display": "X",
          "ordinal": "8"
        }
      },
      {
        "name": "Lisa",
        "league": {
          "leagueAccount": {
            "id": "CcHNuKQIHTWx10iSkKTLu3T25-foRAEchK6YOxVkkprw8no",
            "accountId": "JEL8EcTQKAnxhhSYwjfaDEJCULiABNOLASrmnnG5QuNMy3c",
            "puuid": "f_OAYIvQvsXSU26klci-enHHgZKOBuoU2xg3SBestTxyVOFg_PaufjklzhrPwe90kF0itR55jwy_sQ",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "138906561895464960" }
      },
      {
        "name": "Hirza",
        "league": {
          "leagueAccount": {
            "id": "wXR4_k21Av0OwvxsLjJ5IiFkEuC0OnrsXR3X_WUWCEFD5Nk",
            "accountId": "yqyw1c7LrHLq8S38ByFOKCkQFxNBE-xbF_gHPwjglW5DWDw",
            "puuid": "x1Ci6fUozKWiZYrqO-Q2f3zt46gCD8Hvte5RqHOKcdmH-1VBHr6-X60Klz2zsqnTO7bF2QxLl60fRA",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "528096854831792159" },
        "tier": {
          "display": "B",
          "ordinal": "5"
        }
      },
      {
        "name": "Justin",
        "league": {
          "leagueAccount": {
            "id": "Da3sZ07dKgUOSeg5bpCKtOT_LLvpkeZsDFl7AttZUS_3C-4",
            "accountId": "APQ1qsXDKxhA7oSlM2PGuTBt6goOrubkskPx1UVC7YYly-E",
            "puuid": "2n5udsJWrMZOEkQm8KbL22syLuwk9cWGN9809KL3vaLImOAMZgMLn7YI-iBaJYW12DE5jdyM71EJ3w",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "189534213391908865" },
        "tier": {
          "display": "A",
          "ordinal": "3"
        }
      },
      {
        "name": "Nathan",
        "league": {
          "leagueAccount": {
            "id": "HSWRh_aZE6YJc7sTwvcxUisHLFOfjlHyr6VpAnaXMqAUBVg",
            "accountId": "Vad_2osVJ24CUewLaALXXMIPDfK3P7OT9gW_igxec4EU89Y",
            "puuid": "kX9vu-HMTuwqbk1O6HQa1EcGdhKeqcpJ53QEVanqHk6-B-f4dhRQ1mXO_fOH1TjXoVYBLTOrGD_esA",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "327908907714478080" },
        "tier": {
          "display": "A",
          "ordinal": "3"
        }
      },
      {
        "name": "Virmel",
        "league": {
          "leagueAccount": {
            "id": "Mv2ExMQFAchYyFc2eUaJn2Q62p8sKCOAWX85A8xZm3Ef",
            "accountId": "Sn8wbtiSKpJTrgYSFbZsd9CVepf3XuzM-33JW6_BWms",
            "puuid": "okVQL80zjnT_HMuDoqR3QiuGTKHQNKPDTbRcjeLjhgprfPeWdMPJXTA_sbK3rxDt2tyIdv9SG2V_Lw",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "208425244128444418" },
        "tier": {
          "display": "A",
          "ordinal": "3"
        }
      },
      {
        "name": "Danny",
        "league": {
          "leagueAccount": {
            "id": "pleftlYNvBPZS2aSkv-AoMo-NcrT6C5qavkD3jkELULiPbM",
            "accountId": "h0YBZPKSBXV-TGYeFMWGigZPOI9ervu2z168uhTlYe9u24w",
            "puuid": "PFmOO4HVmc2U_UhEzEjgAiZORKxWRxpdu4YyqI0uEa9PZqSLhg7sABnCuGBiPHd7BwVl6x4OSEK-fQ",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "263577791105073152" }
      },
      {
        "name": "Irfan",
        "league": {
          "leagueAccount": {
            "id": "BTJvZNnOUHFnEICbwyq-5A2ZG-7JOGvbw-87juNrEaSr6PTc",
            "accountId": "h0YBZPKSBXV-TGYeFMWGigZPOI9ervu2z168uhTlYe9u24w",
            "puuid": "beA95KLRaBvnFQt6MhKJniDOH0vp9mhpdCtlOH8tPrvAYO3RLgyPyf1CPmxTZJA_wKjZw6Gv03Yhmg",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "410595870380392458" },
        "tier": {
          "display": "B",
          "ordinal": "4"
        }
      },
      {
        "name": "Caitlyn",
        "league": {
          "leagueAccount": {
            "id": "BB7ZBInbKvaE-LvGEwFEhEo9zvkZGcqDDKJcd5W1bS0Vlxb1VtylUWLpNw",
            "accountId": "EBRpyLP2o-vFiEtrR30rcycJ6Frpu3yCKuTAdWbV5ngvwI0wErx6YZZA",
            "puuid": "GksNHpwZi2ICy9ccgifFytu9DvPtRYxmGmnGxcbe8shr4IFwa0hajbgj0eblVRYyL6oaqil5znDgGg",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "331238905619677185" },
        "tier": {
          "display": "C",
          "ordinal": "5"
        }
      },
      {
        "name": "Richard",
        "league": {
          "leagueAccount": {
            "id": "JZZnBhL1Nn2ReEa-lx3TLEAgQEEnLQbWqO3wWq9ROhuLhtc",
            "accountId": "iZ1INU3eb0Epj65zC_9uK4Hff0XtrIB9ZWCucoQ-AU4S-A",
            "puuid": "6PZP5dzoGkczMn7HGATMCsjYFRLhRktGm11H9rbLyeg_YnlS0yea1C_kZ83JFADHsSEqAbEckBbnNg",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "121887985896521732" },
        "tier": {
          "display": "Valorant",
          "ordinal": "10"
        }
      },
      {
        "name": "Neko Ryan",
        "league": {
          "leagueAccount": {
            "id": "VnpSeVl5vk6l7qNtmTRUGc4UdqHaN7C49U6ZdTTJiqCRc2c",
            "accountId": "gUpqEIRW0I7S8ugSEM0FPh8Qml_5U6m3Pjh2ziTymMflgg",
            "puuid": "4UZQqglJjZd33aWVcOHExc6yhc83iguRmkoCDnxPATBDVqGF_B3YVCp7U0OVfwGvWVn4uURVIvkHQw",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "200067001035653131" },
        "tier": {
          "display": "Debt",
          "ordinal": "6"
        }
      },
      {
        "name": "Long",
        "league": {
          "leagueAccount": {
            "id": "z27c2dEA_YQ1TikXh-NpWpy7XN-FUHYVAg1VymYZGdI4NOw",
            "accountId": "A-qxB7HUhtqWLLcPEh1gik6VOqgK3QvmMMN1BHLxlHjlkX4",
            "puuid": "ZF_grAnZjpHTTmh-RyVax-LCwZVCVLRJMLgTU2BJiUN2UcLYpeq6RZxvRBXlcQpwNVqg-OFNr41qXA",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "251485022429642752" },
        "tier": {
          "display": "B",
          "ordinal": "4"
        }
      },
      {
        "name": "Edward",
        "league": {
          "leagueAccount": {
            "id": "Fxy1jC65qZCtDoUaey1faJGJWMQV55hgHOYF4JwtrATIcSw",
            "accountId": "bI-vI8U5USEuY0AP6y_fHdMF31sGlEXgvGflw3dmwig_0Q",
            "puuid": "aLw-CHkfMnmlaeCR9Mdavh0UusuEitdttlIL-mBqW_NyhwXGbKuq1FVMNv2maN-imIa3r-xLHxRDGw",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "208404668026454016" }
      },
      {
        "name": "Aaron",
        "league": {
          "leagueAccount": {
            "id": "8DBRLP2D8LcfyagWJ0-q5WEM0ALDsfgHZaNOr8ZSaSHyvwY",
            "accountId": "1opmqlc_OR9DOpK4wPrdv3eSAtgboJURSZ47dHKkS72K2g",
            "puuid": "YIBj-FbOFri3kZjbXGigzwOmJx1ljY9cVRXWIp6gPO4VqZ5Qdvt4CbmIIZoq6XHwgKLdDNVZPX8H6w",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "186665676134547461" },
        "tier": {
          "display": "S++",
          "ordinal": "1"
        }
      },
      {
        "name": "Colin",
        "league": {
          "leagueAccount": {
            "id": "vpNHCw_gthZSgcxbhMlx6vPc2CV-BbxbIsOQRwPOObxWjyM",
            "accountId": "tN2WnLPZ0ypBjR5UD9wgFQXqAYeOmve7rkZxGFj1y1ihgg",
            "puuid": "4hc-2NPRPyApehzZ48mKwYHk9I08NJWP41Z3fCZQfEdJjspyS96SJpV1InZwAy2OOj5Y-B_JVGCX5A",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "171455587517857796" },
        "tier": {
          "display": "?",
          "ordinal": "9"
        }
      },
      {
        "name": "Wanye",
        "league": {
          "leagueAccount": {
            "id": "Tgo7M5lQS2ELTQd3N3Xfb7kxO6OOZaiAnQuzQtQ71yIr8n0",
            "accountId": "LMjECS0JDNdakn2ftv4O-Ic5FN679WyjULM_i7ICFMtuyJE",
            "puuid": "JvbEey_NM465IzI92Iu-lyO1vuCrM5Uv28eCXnAkY6X6_8fB_gq8MngCWN8uGbw-TpNH_JP73Oo-Gg",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "327894775103750154" }
      },
      {
        "name": "Jeff",
        "league": {
          "leagueAccount": {
            "id": "tlKA2ghauB_HrNpZJUidamBoRhuXWsc1s6HW7mEJPthdAthr",
            "accountId": "lATx-_ZB9pRypymY-QnneIBQ8xWq7qDJTuHxZ72NVGbwa0kBvk_GvcRk",
            "puuid": "97fYJdl3sP_NNmju5p6Y2YkwQaZTYXjdOaKDR9J6J-3bHQf5RAts1Y1nyarnP3Ez9tB8SJnEqAD8Gw",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "378335152331554836" }
      },
      {
        "name": "Joel",
        "league": {
          "leagueAccount": {
            "id": "nm0GrBxItUSP_OIGPc7nVpBgJWsQvu3nAhJMAScu2d1KvsY",
            "accountId": "WYMGna0Vz03WKvh7q1Lc2xfNWrJOxXn3bCERVppaawa_Pg",
            "puuid": "beyeGCFvx9bxEqv67MAC8i_CrlBde5JNvNjFKD1OGvKsfZzP9m1nx2u_Lj5-TVHTENHu_MKfIwCp6A",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "282716540053225472" },
        "tier": {
          "display": "B",
          "ordinal": "4"
        }
      },
      {
        "name": "Jake",
        "league": {
          "leagueAccount": {
            "id": "zWmZRsnC6szqQHT5zTVVEtS0Sps4PaGBf-PD93MPOC9tMpU",
            "accountId": "Df8AzcdGVYvw7nWkoJmmQf3MIsEL8ugzRbKufT35f815T7E",
            "puuid": "P14duZWshXWprvjn1u_sAblNYARfpvbxiv7PvcWPYKSlSGVUUd850GLSCpexkNVazR3KlRI8RgD9tA",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "108659981309468672" },
        "tier": {
          "display": "F",
          "ordinal": "6"
        }
      },
      {
        "name": "Kendrick",
        "league": {
          "leagueAccount": {
            "id": "q4BjYY-8XDE-YXDUXiHCNbjN5biTnqNuMseHDxcTqIanpjE",
            "accountId": "RF_kmDh3U1NvY_Lr2NW1lzmwgHBLFAwGcqcX35-l-kklqA",
            "puuid": "BxEyY6sX-bWFvtXtRD3IWIbmm5Wa7WFSfwOUjOsbhcxDknt8tK8VzfSTBsoGnllxsqqaIV8qTRr8nQ",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "89243433385881600" }
      },
      {
        "name": "Brandon",
        "league": {
          "leagueAccount": {
            "id": "xeGfv3o7hUEKA8DE4gEIIb16EhXVov-vao-FkqWPnmK5DK4",
            "accountId": "eCsEgIP3QXpIkGMY8wRIEBNvu6w2C2OdxOu2WPxx2BwJJg",
            "puuid": "eNfkTOITU7rdr3a_DEWZBE14PLXXIC7h8oM6UkwGO8nl8cxdRjtaLuzroqVWjg4x0d3EyfqNATvZUQ",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "89800891070164992" }
      },
      {
        "name": "Sean",
        "league": {
          "leagueAccount": {
            "id": "EuNtjpJ3MeGk0FlNeCacXH7--osods1zZ0_NzqpTn5zqB8Q",
            "accountId": "N2CMkF6N1OANuGWgG6uERDVdTeTMKqEb_d-ql73_T2LUTdI",
            "puuid": "iW0QqUuzfP54yuoV_XmZUZDBp4BGRLp9xZmo72Gb0Dk9GWIYoLMOpAik4re3D9KGMsSgroM6UibW6g",
            "region": "AMERICA_NORTH"
          },
          "alts": []
        },
        "discordAccount": { "id": "328301941048344577" },
        "tier": {
          "display": "B",
          "ordinal": "4"
        }
      }
    ]
immutable: false
---
apiVersion: onepassword.com/v1
kind: OnePasswordItem
metadata:
  name: glitter-boys-prod-discord-token
  namespace: glitter-boys-prod
spec:
  itemPath: vaults/v64ocnykdqju4ui6j6pua56xw4/items/plb6l2bksn56zfmmwtogu3yvp4
---
apiVersion: onepassword.com/v1
kind: OnePasswordItem
metadata:
  name: glitter-boys-prod-aws-access-key
  namespace: glitter-boys-prod
spec:
  itemPath: vaults/v64ocnykdqju4ui6j6pua56xw4/items/auced424ojvxlkszvredtmllsu
---
apiVersion: onepassword.com/v1
kind: OnePasswordItem
metadata:
  name: glitter-boys-prod-riot-api-key
  namespace: glitter-boys-prod
spec:
  itemPath: vaults/v64ocnykdqju4ui6j6pua56xw4/items/oyn2omqw5z5vmg4vcvihleq4fm
---
apiVersion: v1
kind: Service
metadata:
  name: glitter-boys-prod-glitter-boys-service
  namespace: glitter-boys-prod
spec:
  externalIPs: []
  ports:
    - port: 8000
  selector:
    cdk8s.io/metadata.addr: glitter-boys-prod-glitter-backend-c8cbcc79
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    tailscale.com/funnel: "true"
  name: glitter-boys-prod-glitter-boys-ingress-ingress
  namespace: glitter-boys-prod
spec:
  defaultBackend:
    service:
      name: glitter-boys-prod-glitter-boys-service
      port:
        number: 8000
  ingressClassName: tailscale
  tls:
    - hosts:
        - glitter-boys-prod
