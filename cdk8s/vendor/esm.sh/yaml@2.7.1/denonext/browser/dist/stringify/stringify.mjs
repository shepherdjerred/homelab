/* esm.sh - yaml@2.7.1/browser/dist/stringify/stringify */
import{anchorIsValid as d}from"../doc/anchors.mjs";import{isPair as u,isAlias as g,isNode as c,isScalar as a,isCollection as h}from"../nodes/identity.mjs";import{stringifyComment as S}from"./stringifyComment.mjs";import{stringifyString as y}from"./stringifyString.mjs";function $(e,t){let o=Object.assign({blockQuote:!0,commentString:S,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t),i;switch(o.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:e,flowCollectionPadding:o.flowCollectionPadding?" ":"",indent:"",indentStep:typeof o.indent=="number"?" ".repeat(o.indent):"  ",inFlow:i,options:o}}function p(e,t){if(t.tag){let n=e.filter(r=>r.tag===t.tag);if(n.length>0)return n.find(r=>r.format===t.format)??n[0]}let o,i;if(a(t)){i=t.value;let n=e.filter(r=>r.identify?.(i));if(n.length>1){let r=n.filter(l=>l.test);r.length>0&&(n=r)}o=n.find(r=>r.format===t.format)??n.find(r=>!r.format)}else i=t,o=e.find(n=>n.nodeClass&&i instanceof n.nodeClass);if(!o){let n=i?.constructor?.name??typeof i;throw new Error(`Tag not resolved for ${n} value`)}return o}function v(e,t,{anchors:o,doc:i}){if(!i.directives)return"";let n=[],r=(a(e)||h(e))&&e.anchor;r&&d(r)&&(o.add(r),n.push(`&${r}`));let l=e.tag?e.tag:t.default?null:t.tag;return l&&n.push(i.directives.tagString(l)),n.join(" ")}function j(e,t,o,i){if(u(e))return e.toString(t,o,i);if(g(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let n,r=c(e)?e:t.doc.createNode(e,{onTagObj:f=>n=f});n||(n=p(t.doc.schema.tags,r));let l=v(r,n,t);l.length>0&&(t.indentAtStart=(t.indentAtStart??0)+l.length+1);let s=typeof n.stringify=="function"?n.stringify(r,t,o,i):a(r)?y(r,t,o,i):r.toString(t,o,i);return l?a(r)||s[0]==="{"||s[0]==="["?`${l} ${s}`:`${l}
${t.indent}${s}`:s}export{$ as createStringifyContext,j as stringify};
//# sourceMappingURL=stringify.mjs.map