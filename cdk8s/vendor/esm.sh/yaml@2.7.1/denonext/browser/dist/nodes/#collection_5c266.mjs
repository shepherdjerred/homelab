/* esm.sh - yaml@2.7.1/browser/dist/nodes/Collection */
import{createNode as f}from"../doc/createNode.mjs";import{isNode as d,isPair as c,isCollection as i,isScalar as a}from"./identity.mjs";import{NodeBase as m}from"./Node.mjs";function h(o,n,t){let e=t;for(let s=n.length-1;s>=0;--s){let r=n[s];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){let l=[];l[r]=e,e=l}else e=new Map([[r,e]])}return f(e,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:o,sourceObjects:new Map})}var g=o=>o==null||typeof o=="object"&&!!o[Symbol.iterator]().next().done,u=class extends m{constructor(n,t){super(n),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(n){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return n&&(t.schema=n),t.items=t.items.map(e=>d(e)||c(e)?e.clone(n):e),this.range&&(t.range=this.range.slice()),t}addIn(n,t){if(g(n))this.add(t);else{let[e,...s]=n,r=this.get(e,!0);if(i(r))r.addIn(s,t);else if(r===void 0&&this.schema)this.set(e,h(this.schema,s,t));else throw new Error(`Expected YAML collection at ${e}. Remaining path: ${s}`)}}deleteIn(n){let[t,...e]=n;if(e.length===0)return this.delete(t);let s=this.get(t,!0);if(i(s))return s.deleteIn(e);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${e}`)}getIn(n,t){let[e,...s]=n,r=this.get(e,!0);return s.length===0?!t&&a(r)?r.value:r:i(r)?r.getIn(s,t):void 0}hasAllNullValues(n){return this.items.every(t=>{if(!c(t))return!1;let e=t.value;return e==null||n&&a(e)&&e.value==null&&!e.commentBefore&&!e.comment&&!e.tag})}hasIn(n){let[t,...e]=n;if(e.length===0)return this.has(t);let s=this.get(t,!0);return i(s)?s.hasIn(e):!1}setIn(n,t){let[e,...s]=n;if(s.length===0)this.set(e,t);else{let r=this.get(e,!0);if(i(r))r.setIn(s,t);else if(r===void 0&&this.schema)this.set(e,h(this.schema,s,t));else throw new Error(`Expected YAML collection at ${e}. Remaining path: ${s}`)}}};export{u as Collection,h as collectionFromPath,g as isEmptyPath};
//# sourceMappingURL=Collection.mjs.map