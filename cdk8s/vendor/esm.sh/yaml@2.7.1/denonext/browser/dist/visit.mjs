/* esm.sh - yaml@2.7.1/browser/dist/visit */
import{isDocument as m,isNode as j,isPair as b,isCollection as S,isMap as M,isSeq as N,isScalar as o,isAlias as E}from"./nodes/identity.mjs";var i=Symbol("break visit"),V=Symbol("skip children"),s=Symbol("remove node");function y(e,l){let t=w(l);m(e)?r(null,e.contents,t,Object.freeze([e]))===s&&(e.contents=null):r(null,e,t,Object.freeze([]))}y.BREAK=i;y.SKIP=V;y.REMOVE=s;function r(e,l,t,c){let n=z(e,l,t,c);if(j(n)||b(n))return A(e,c,n),r(e,n,t,c);if(typeof n!="symbol"){if(S(l)){c=Object.freeze(c.concat(l));for(let f=0;f<l.items.length;++f){let u=r(f,l.items[f],t,c);if(typeof u=="number")f=u-1;else{if(u===i)return i;u===s&&(l.items.splice(f,1),f-=1)}}}else if(b(l)){c=Object.freeze(c.concat(l));let f=r("key",l.key,t,c);if(f===i)return i;f===s&&(l.key=null);let u=r("value",l.value,t,c);if(u===i)return i;u===s&&(l.value=null)}}return n}async function O(e,l){let t=w(l);m(e)?await a(null,e.contents,t,Object.freeze([e]))===s&&(e.contents=null):await a(null,e,t,Object.freeze([]))}O.BREAK=i;O.SKIP=V;O.REMOVE=s;async function a(e,l,t,c){let n=await z(e,l,t,c);if(j(n)||b(n))return A(e,c,n),a(e,n,t,c);if(typeof n!="symbol"){if(S(l)){c=Object.freeze(c.concat(l));for(let f=0;f<l.items.length;++f){let u=await a(f,l.items[f],t,c);if(typeof u=="number")f=u-1;else{if(u===i)return i;u===s&&(l.items.splice(f,1),f-=1)}}}else if(b(l)){c=Object.freeze(c.concat(l));let f=await a("key",l.key,t,c);if(f===i)return i;f===s&&(l.key=null);let u=await a("value",l.value,t,c);if(u===i)return i;u===s&&(l.value=null)}}return n}function w(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function z(e,l,t,c){if(typeof t=="function")return t(e,l,c);if(M(l))return t.Map?.(e,l,c);if(N(l))return t.Seq?.(e,l,c);if(b(l))return t.Pair?.(e,l,c);if(o(l))return t.Scalar?.(e,l,c);if(E(l))return t.Alias?.(e,l,c)}function A(e,l,t){let c=l[l.length-1];if(S(c))c.items[e]=t;else if(b(c))e==="key"?c.key=t:c.value=t;else if(m(c))c.contents=t;else{let n=E(c)?"alias":"scalar";throw new Error(`Cannot replace node with ${n} parent`)}}export{y as visit,O as visitAsync};
//# sourceMappingURL=visit.mjs.map