/* esm.sh - yaml@2.8.0/browser/dist/stringify/stringify */
import{anchorIsValid as d}from"../doc/anchors.mjs";import{isPair as u,isAlias as g,isNode as c,isScalar as a,isCollection as h}from"../nodes/identity.mjs";import{stringifyComment as S}from"./stringifyComment.mjs";import{stringifyString as y}from"./stringifyString.mjs";function $(r,t){let l=Object.assign({blockQuote:!0,commentString:S,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},r.schema.toStringOptions,t),i;switch(l.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:r,flowCollectionPadding:l.flowCollectionPadding?" ":"",indent:"",indentStep:typeof l.indent=="number"?" ".repeat(l.indent):"  ",inFlow:i,options:l}}function p(r,t){if(t.tag){let e=r.filter(n=>n.tag===t.tag);if(e.length>0)return e.find(n=>n.format===t.format)??e[0]}let l,i;if(a(t)){i=t.value;let e=r.filter(n=>n.identify?.(i));if(e.length>1){let n=e.filter(o=>o.test);n.length>0&&(e=n)}l=e.find(n=>n.format===t.format)??e.find(n=>!n.format)}else i=t,l=r.find(e=>e.nodeClass&&i instanceof e.nodeClass);if(!l){let e=i?.constructor?.name??(i===null?"null":typeof i);throw new Error(`Tag not resolved for ${e} value`)}return l}function v(r,t,{anchors:l,doc:i}){if(!i.directives)return"";let e=[],n=(a(r)||h(r))&&r.anchor;n&&d(n)&&(l.add(n),e.push(`&${n}`));let o=r.tag??(t.default?null:t.tag);return o&&e.push(i.directives.tagString(o)),e.join(" ")}function j(r,t,l,i){if(u(r))return r.toString(t,l,i);if(g(r)){if(t.doc.directives)return r.toString(t);if(t.resolvedAliases?.has(r))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(r):t.resolvedAliases=new Set([r]),r=r.resolve(t.doc)}let e,n=c(r)?r:t.doc.createNode(r,{onTagObj:f=>e=f});e??(e=p(t.doc.schema.tags,n));let o=v(n,e,t);o.length>0&&(t.indentAtStart=(t.indentAtStart??0)+o.length+1);let s=typeof e.stringify=="function"?e.stringify(n,t,l,i):a(n)?y(n,t,l,i):n.toString(t,l,i);return o?a(n)||s[0]==="{"||s[0]==="["?`${o} ${s}`:`${o}
${t.indent}${s}`:s}export{$ as createStringifyContext,j as stringify};
//# sourceMappingURL=stringify.mjs.map