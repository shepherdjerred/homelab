/* esm.sh - yaml@2.7.0/browser/dist/nodes/YAMLMap */
import{stringifyCollection as p}from"../stringify/stringifyCollection.mjs";import{addPairToJSMap as y}from"./addPairToJSMap.mjs";import{Collection as v}from"./Collection.mjs";import{isPair as d,isScalar as u,MAP as g}from"./identity.mjs";import{Pair as m,createPair as w}from"./Pair.mjs";import{isScalarValue as k}from"./Scalar.mjs";function a(c,e){let i=u(e)?e.value:e;for(let t of c)if(d(t)&&(t.key===e||t.key===i||u(t.key)&&t.key.value===i))return t}var h=class extends v{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(g,e),this.items=[]}static from(e,i,t){let{keepUndefined:s,replacer:r}=t,o=new this(e),l=(n,f)=>{if(typeof r=="function")f=r.call(i,n,f);else if(Array.isArray(r)&&!r.includes(n))return;(f!==void 0||s)&&o.items.push(w(n,f,t))};if(i instanceof Map)for(let[n,f]of i)l(n,f);else if(i&&typeof i=="object")for(let n of Object.keys(i))l(n,i[n]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,i){let t;d(e)?t=e:!e||typeof e!="object"||!("key"in e)?t=new m(e,e?.value):t=new m(e.key,e.value);let s=a(this.items,t.key),r=this.schema?.sortMapEntries;if(s){if(!i)throw new Error(`Key ${t.key} already set`);u(s.value)&&k(t.value)?s.value.value=t.value:s.value=t.value}else if(r){let o=this.items.findIndex(l=>r(t,l)<0);o===-1?this.items.push(t):this.items.splice(o,0,t)}else this.items.push(t)}delete(e){let i=a(this.items,e);return i?this.items.splice(this.items.indexOf(i),1).length>0:!1}get(e,i){let s=a(this.items,e)?.value;return(!i&&u(s)?s.value:s)??void 0}has(e){return!!a(this.items,e)}set(e,i){this.add(new m(e,i),!0)}toJSON(e,i,t){let s=t?new t:i?.mapAsMap?new Map:{};i?.onCreate&&i.onCreate(s);for(let r of this.items)y(i,s,r);return s}toString(e,i,t){if(!e)return JSON.stringify(this);for(let s of this.items)if(!d(s))throw new Error(`Map items must all be pairs; found ${JSON.stringify(s)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),p(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:t,onComment:i})}};export{h as YAMLMap,a as findPair};
//# sourceMappingURL=YAMLMap.mjs.map